# .claude/rules/ ベストプラクティス

## 目次

- [構造のガイドライン](#構造のガイドライン)
  - [ファイル配置](#ファイル配置)
  - [ファイル命名規則](#ファイル命名規則)
- [内容のガイドライン](#内容のガイドライン)
  - [良いルールの特徴](#良いルールの特徴)
  - [例: 良いルール](#例-良いルール)
  - [例: 悪いルール](#例-悪いルール)
- [条件付きルール（paths）](#条件付きルールpaths)
  - [使用すべき場合](#使用すべき場合)
  - [使用を避けるべき場合](#使用を避けるべき場合)
  - [パターン例](#パターン例)
- [シンボリックリンク](#シンボリックリンク)
- [ユーザーレベルルール](#ユーザーレベルルール)

---

## 構造のガイドライン

### ファイル配置

```
.claude/rules/
├── general.md           # 全般的なルール
├── code-style.md        # コードスタイル
├── testing.md           # テスト規約
├── security.md          # セキュリティ要件
├── frontend/            # フロントエンド関連
│   ├── react.md
│   ├── styles.md
│   └── accessibility.md
├── backend/             # バックエンド関連
│   ├── api.md
│   ├── database.md
│   └── validation.md
└── shared/              # 共有ルール
    └── naming.md
```

### ファイル命名規則

- ケバブケースを使用: `code-style.md`, `api-design.md`
- 内容を反映した名前: `testing.md` > `test.md`
- 短く簡潔に: `react.md` > `react-component-guidelines.md`

## 内容のガイドライン

### 良いルールの特徴

1. **具体的**: 曖昧さがない
2. **実行可能**: 従えるかどうか判断できる
3. **簡潔**: 必要最小限の説明
4. **構造化**: 見出しとリストで整理

### 例: 良いルール

```markdown
# TypeScript コードスタイル

- 2スペースインデントを使用
- セミコロンを省略しない
- `any`型を避け、具体的な型を定義
- 関数の戻り値型を明示
- インターフェースは`I`プレフィックスを付けない
```

### 例: 悪いルール

```markdown
# コードスタイル

- コードをきれいに書く
- 適切な名前を付ける
- テストを書く
```

## 条件付きルール（paths）

### 使用すべき場合

- 言語固有のルール（TypeScript, Python等）
- ディレクトリ固有のルール（src/, tests/等）
- ファイル種別固有のルール（コンポーネント、テスト等）

### 使用を避けるべき場合

- プロジェクト全体に適用すべきルール
- 曖昧なパターン

### パターン例

```markdown
---
paths: src/api/**/*.ts
---

# API開発ルール

- 全エンドポイントに入力バリデーションを含める
- 標準エラーレスポンス形式を使用
- OpenAPIドキュメントコメントを含める
```

```markdown
---
paths: **/*.test.{ts,tsx}
---

# テストファイルルール

- describeブロックでテストをグループ化
- テスト名は「〜すべき」形式で記述
- Arrange-Act-Assertパターンを使用
```

```markdown
---
paths: src/components/**/*.tsx
---

# Reactコンポーネントルール

- 関数コンポーネントを使用
- Propsの型を明示的に定義
- useCallbackでイベントハンドラをメモ化
```

## シンボリックリンク

共通ルールを複数プロジェクトで共有：

```bash
# 共有ルールディレクトリをリンク
ln -s ~/shared-claude-rules .claude/rules/shared

# 個別ファイルをリンク
ln -s ~/company-standards/security.md .claude/rules/security.md
```

## ユーザーレベルルール

`~/.claude/rules/`に個人用ルールを配置：

```
~/.claude/rules/
├── preferences.md    # 個人のコーディング好み
└── workflows.md      # 好みのワークフロー
```

ユーザーレベルルールはプロジェクトルールより優先度が低い。
