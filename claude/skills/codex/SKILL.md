---
name: codex
description: Codex CLI（OpenAI）を使用してコード、設計、実装について相談・レビューを行う。別の視点からのフィードバックが欲しい時、セカンドオピニオンを求める時、コードレビューを依頼する時、設計の妥当性を確認したい時に使用する。「codexに相談」「セカンドオピニオン」「別の視点で確認」などで起動。
---

# Codex

Codex CLI（OpenAI）を使用して、コードや設計について相談・レビューを行う。

## 判断フロー

```
ユーザーのリクエスト
    │
    ├─ git差分のレビュー？ ─────→ codex review
    │
    ├─ 特定の質問・相談？ ──────→ codex exec "質問内容"
    │
    └─ 対話的に相談したい？ ────→ codex "質問"
```

## コマンド

### codex review（git差分レビュー用）

```bash
# ステージされた変更をレビュー
codex review --uncommitted

# 特定のブランチとの差分をレビュー
codex review --base main

# 特定のコミットをレビュー
codex review --commit <SHA>

# カスタム指示でレビュー
codex review "セキュリティの観点でレビューして"
```

### codex exec（非対話的な質問用）

```bash
codex exec "この設計パターンの問題点は何ですか？"
```

### codex（対話モード）

```bash
codex "このコードをリファクタリングするベストな方法は？"
```

## ワークフロー

1. ユーザーが相談内容を指定
2. 判断フローに従って適切なコマンドを選択
3. コマンドを実行
4. 結果をユーザーに報告

### 例: コードレビューを依頼

```
ユーザー: 「今の変更をcodexでレビューして」
→ git差分のレビュー → codex review --uncommitted を実行
→ レビュー結果を報告
```

### 例: 設計について相談

```
ユーザー: 「このアーキテクチャについてcodexに相談したい」
→ 特定の質問 → codex exec "..." で設計内容を渡して実行
→ フィードバックを報告
```

## エラー時の対応

- **codexコマンドが見つからない**: `brew install openai/openai/codex` でインストールを案内
- **認証エラー**: `codex login` で認証を案内
- **タイムアウト**: リトライまたは質問を簡潔にして再実行
